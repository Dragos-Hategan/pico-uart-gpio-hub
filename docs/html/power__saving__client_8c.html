<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pico UART GPIO Hub: src/client/power_saving_client.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Pico UART GPIO Hub
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('power__saving__client_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">power_saving_client.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Power-saving configuration and dormant mode handling for UART-based clients.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="client_8h_source.html">client.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="functions_8h_source.html">functions.h</a>&quot;</code><br />
<code>#include &quot;hardware/clocks.h&quot;</code><br />
<code>#include &quot;hardware/structs/clocks.h&quot;</code><br />
<code>#include &quot;hardware/regs/clocks.h&quot;</code><br />
<code>#include &quot;hardware/regs/rosc.h&quot;</code><br />
<code>#include &quot;hardware/structs/rosc.h&quot;</code><br />
<code>#include &quot;hardware/pll.h&quot;</code><br />
<code>#include &quot;hardware/xosc.h&quot;</code><br />
<code>#include &quot;pico/runtime_init.h&quot;</code><br />
<code>#include &quot;hardware/powman.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a146ab45612da7bcaea2f6ef4f91a8c17" id="r_a146ab45612da7bcaea2f6ef4f91a8c17"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a> { <a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17aaa1a3b8d687d24915b28de987d9d0a84">DORMANT_SOURCE_NONE</a>
, <a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17ace737924c3441c4df9d7b18cfaa024c6">DORMANT_SOURCE_XOSC</a>
, <a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17aa1b871030493c549e8c4a6e59414ae69">DORMANT_SOURCE_ROSC</a>
, <a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17a58e5a7829980c01b8e6336498c0e247b">DORMANT_SOURCE_LPOSC</a>
 }</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a426a50aa91cd43d99cbbce51c651a509" id="r_a426a50aa91cd43d99cbbce51c651a509"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a426a50aa91cd43d99cbbce51c651a509">client_turn_off_unused_power_consumers</a> (void)</td></tr>
<tr class="memdesc:a426a50aa91cd43d99cbbce51c651a509"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces power consumption by disabling unused clocks and reconfiguring system clocks.  <br /></td></tr>
<tr class="memitem:af3d962ac5095aa3f473afe2979ecd97e" id="r_af3d962ac5095aa3f473afe2979ecd97e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3d962ac5095aa3f473afe2979ecd97e">set_pin_as_input_for_dormant_wakeup</a> (void)</td></tr>
<tr class="memdesc:af3d962ac5095aa3f473afe2979ecd97e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the TX pin as input with pull-down for dormant wakeup.  <br /></td></tr>
<tr class="memitem:a5ee3f85a412d78f1314ff288c480ac2f" id="r_a5ee3f85a412d78f1314ff288c480ac2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ee3f85a412d78f1314ff288c480ac2f">power_saving_config</a> (void)</td></tr>
<tr class="memdesc:a5ee3f85a412d78f1314ff288c480ac2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the system for power saving.  <br /></td></tr>
<tr class="memitem:a40250ad97b28d975e11dedb04e2155ac" id="r_a40250ad97b28d975e11dedb04e2155ac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40250ad97b28d975e11dedb04e2155ac">rosc_clear_bad_write</a> (void)</td></tr>
<tr class="memitem:a9cbb7880d86f42b6cd982fc5dbb9e629" id="r_a9cbb7880d86f42b6cd982fc5dbb9e629"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9cbb7880d86f42b6cd982fc5dbb9e629">rosc_write_okay</a> (void)</td></tr>
<tr class="memitem:a6a036926488845c153e65c244eb723be" id="r_a6a036926488845c153e65c244eb723be"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a036926488845c153e65c244eb723be">rosc_write</a> (io_rw_32 *addr, uint32_t value)</td></tr>
<tr class="memitem:af2d5d3568fc2b3667d178e97afbe40d1" id="r_af2d5d3568fc2b3667d178e97afbe40d1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2d5d3568fc2b3667d178e97afbe40d1">go_dormant</a> (void)</td></tr>
<tr class="memitem:a505de6d7122b8fe20e95bb0dc84bd575" id="r_a505de6d7122b8fe20e95bb0dc84bd575"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a505de6d7122b8fe20e95bb0dc84bd575">rosc_disable</a> (void)</td></tr>
<tr class="memitem:adf98b0492af43397ee03acd23268e637" id="r_adf98b0492af43397ee03acd23268e637"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf98b0492af43397ee03acd23268e637">rosc_set_dormant</a> (void)</td></tr>
<tr class="memitem:aa50017b61f031915e28bd1bb2b023529" id="r_aa50017b61f031915e28bd1bb2b023529"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa50017b61f031915e28bd1bb2b023529">dormant_source_valid</a> (<a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a> dormant_source)</td></tr>
<tr class="memdesc:aa50017b61f031915e28bd1bb2b023529"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the specified dormant source is supported on the current platform.  <br /></td></tr>
<tr class="memitem:a9fca88336fe4601d4a5d155157b0c44c" id="r_a9fca88336fe4601d4a5d155157b0c44c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9fca88336fe4601d4a5d155157b0c44c">_go_dormant</a> (void)</td></tr>
<tr class="memitem:a5774403029c05bbcfbf567b0511c2083" id="r_a5774403029c05bbcfbf567b0511c2083"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5774403029c05bbcfbf567b0511c2083">sleep_run_from_dormant_source</a> (<a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a> dormant_source)</td></tr>
<tr class="memdesc:a5774403029c05bbcfbf567b0511c2083"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the system clocks for low-power dormant wake-up and reinitializes UART.  <br /></td></tr>
<tr class="memitem:adf5393be97de9f28e2ed9623821af643" id="r_adf5393be97de9f28e2ed9623821af643"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf5393be97de9f28e2ed9623821af643">sleep_goto_dormant_until_pin</a> (uint gpio_pin, bool edge, bool high)</td></tr>
<tr class="memdesc:adf5393be97de9f28e2ed9623821af643"><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts the system into dormant mode until a specified GPIO pin triggers a wake-up event.  <br /></td></tr>
<tr class="memitem:a0a782698565460ac496dcb98e1e9cab6" id="r_a0a782698565460ac496dcb98e1e9cab6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a782698565460ac496dcb98e1e9cab6">enter_dormant_mode</a> (void)</td></tr>
<tr class="memdesc:a0a782698565460ac496dcb98e1e9cab6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enters low-power dormant mode using ROSC as the clock source.  <br /></td></tr>
<tr class="memitem:ab2239c7a0c007b59d23bb0f7dbb2430c" id="r_ab2239c7a0c007b59d23bb0f7dbb2430c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2239c7a0c007b59d23bb0f7dbb2430c">rosc_enable</a> (void)</td></tr>
<tr class="memitem:ac7762074b2ad0649a759f25946d3ec7d" id="r_ac7762074b2ad0649a759f25946d3ec7d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac7762074b2ad0649a759f25946d3ec7d">sleep_power_up</a> (void)</td></tr>
<tr class="memdesc:ac7762074b2ad0649a759f25946d3ec7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restores system clocks and peripherals after wake-up from dormant mode.  <br /></td></tr>
<tr class="memitem:aa31d7757cf6582965276700e895ba493" id="r_aa31d7757cf6582965276700e895ba493"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa31d7757cf6582965276700e895ba493">wake_up</a> (void)</td></tr>
<tr class="memdesc:aa31d7757cf6582965276700e895ba493"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wakes up the system from dormant mode and reinitializes UART.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2a8bb21ddcce42f2ee025d4f14423fcd" id="r_a2a8bb21ddcce42f2ee025d4f14423fcd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a8bb21ddcce42f2ee025d4f14423fcd">go_dormant_flag</a> = false</td></tr>
<tr class="memitem:a3a68e44005c8a23a680dce890b33a7f9" id="r_a3a68e44005c8a23a680dce890b33a7f9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a68e44005c8a23a680dce890b33a7f9">woke_up_from_dormant</a> = false</td></tr>
<tr class="memitem:aab87f4028722fe344fab2aafea188493" id="r_aab87f4028722fe344fab2aafea188493"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab87f4028722fe344fab2aafea188493">_dormant_source</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Power-saving configuration and dormant mode handling for UART-based clients. </p>
<p>This file contains functions for:</p><ul>
<li>Disabling unused clocks and peripherals to reduce power consumption</li>
<li>Setting up GPIO pins for wake-up events from dormant mode</li>
<li>Switching clock sources for low-power operation (ROSC, XOSC, LPOSC)</li>
<li>Entering and exiting dormant mode on RP2040 or RP2350</li>
<li>Restoring system state and UART after wake-up</li>
</ul>
<p>Supports both RP2040 and RP2350 platforms, with conditional configuration for timers, power management units, and oscillator options.</p>
<dl class="section note"><dt>Note</dt><dd>Used by UART clients to enter low-power state and wake up safely on RX activity.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a0a782698565460ac496dcb98e1e9cab6" title="Enters low-power dormant mode using ROSC as the clock source.">enter_dormant_mode()</a> </dd>
<dd>
<a class="el" href="#aa31d7757cf6582965276700e895ba493" title="Wakes up the system from dormant mode and reinitializes UART.">wake_up()</a> </dd>
<dd>
<a class="el" href="#a5774403029c05bbcfbf567b0511c2083" title="Prepares the system clocks for low-power dormant wake-up and reinitializes UART.">sleep_run_from_dormant_source()</a> </dd>
<dd>
<a class="el" href="#adf5393be97de9f28e2ed9623821af643" title="Puts the system into dormant mode until a specified GPIO pin triggers a wake-up event.">sleep_goto_dormant_until_pin()</a> </dd>
<dd>
<a class="el" href="#a5ee3f85a412d78f1314ff288c480ac2f" title="Prepares the system for power saving.">power_saving_config()</a> </dd></dl>
</div><a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="a146ab45612da7bcaea2f6ef4f91a8c17" name="a146ab45612da7bcaea2f6ef4f91a8c17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a146ab45612da7bcaea2f6ef4f91a8c17">&#9670;&#160;</a></span>dormant_source_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a146ab45612da7bcaea2f6ef4f91a8c17aaa1a3b8d687d24915b28de987d9d0a84" name="a146ab45612da7bcaea2f6ef4f91a8c17aaa1a3b8d687d24915b28de987d9d0a84"></a>DORMANT_SOURCE_NONE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a146ab45612da7bcaea2f6ef4f91a8c17ace737924c3441c4df9d7b18cfaa024c6" name="a146ab45612da7bcaea2f6ef4f91a8c17ace737924c3441c4df9d7b18cfaa024c6"></a>DORMANT_SOURCE_XOSC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a146ab45612da7bcaea2f6ef4f91a8c17aa1b871030493c549e8c4a6e59414ae69" name="a146ab45612da7bcaea2f6ef4f91a8c17aa1b871030493c549e8c4a6e59414ae69"></a>DORMANT_SOURCE_ROSC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a146ab45612da7bcaea2f6ef4f91a8c17a58e5a7829980c01b8e6336498c0e247b" name="a146ab45612da7bcaea2f6ef4f91a8c17a58e5a7829980c01b8e6336498c0e247b"></a>DORMANT_SOURCE_LPOSC&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a9fca88336fe4601d4a5d155157b0c44c" name="a9fca88336fe4601d4a5d155157b0c44c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fca88336fe4601d4a5d155157b0c44c">&#9670;&#160;</a></span>_go_dormant()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _go_dormant </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a426a50aa91cd43d99cbbce51c651a509" name="a426a50aa91cd43d99cbbce51c651a509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a426a50aa91cd43d99cbbce51c651a509">&#9670;&#160;</a></span>client_turn_off_unused_power_consumers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void client_turn_off_unused_power_consumers </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reduces power consumption by disabling unused clocks and reconfiguring system clocks. </p>
<p>This function turns off unnecessary peripherals and clock outputs (e.g., ADC, RTC, GPOUT), switches to lower-frequency XOSC-based system clocks (12 MHz), disables the system PLL, and enables only essential clock domains for sleep mode operation. </p>

</div>
</div>
<a id="aa50017b61f031915e28bd1bb2b023529" name="aa50017b61f031915e28bd1bb2b023529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa50017b61f031915e28bd1bb2b023529">&#9670;&#160;</a></span>dormant_source_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool dormant_source_valid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a></td>          <td class="paramname"><span class="paramname"><em>dormant_source</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the specified dormant source is supported on the current platform. </p>
<p>Validates whether the given <span class="tt"><a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a></span> enum value represents a supported oscillator source for entering dormant mode (e.g., XOSC, ROSC, or LPOSC on non-RP2040 platforms).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dormant_source</td><td>The dormant source to validate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><span class="tt">true</span> if the source is supported on the current platform, <span class="tt">false</span> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>LPOSC is only available on platforms other than RP2040. </dd></dl>

</div>
</div>
<a id="a0a782698565460ac496dcb98e1e9cab6" name="a0a782698565460ac496dcb98e1e9cab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a782698565460ac496dcb98e1e9cab6">&#9670;&#160;</a></span>enter_dormant_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enter_dormant_mode </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enters low-power dormant mode using ROSC as the clock source. </p>
<p>Configures the system to use the ROSC oscillator, then enters dormant mode. The system will remain in dormant state until a high level is detected on the TX pin of the active UART connection.</p>
<dl class="section note"><dt>Note</dt><dd>Assumes <span class="tt">active_uart_client_connection</span> is correctly initialized. The TX pin is used as the wake-up source.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>GPIO configuration for the wake-up pin must be compatible with level-high wake detection, or the system may fail to resume.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a5774403029c05bbcfbf567b0511c2083" title="Prepares the system clocks for low-power dormant wake-up and reinitializes UART.">sleep_run_from_dormant_source()</a> </dd>
<dd>
<a class="el" href="#adf5393be97de9f28e2ed9623821af643" title="Puts the system into dormant mode until a specified GPIO pin triggers a wake-up event.">sleep_goto_dormant_until_pin()</a> </dd></dl>

</div>
</div>
<a id="af2d5d3568fc2b3667d178e97afbe40d1" name="af2d5d3568fc2b3667d178e97afbe40d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2d5d3568fc2b3667d178e97afbe40d1">&#9670;&#160;</a></span>go_dormant()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void go_dormant </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5ee3f85a412d78f1314ff288c480ac2f" name="a5ee3f85a412d78f1314ff288c480ac2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ee3f85a412d78f1314ff288c480ac2f">&#9670;&#160;</a></span>power_saving_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void power_saving_config </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares the system for power saving. </p>
<p>Turns off unused components and sets up the wake-up pin for dormant mode. Currently supported only on boards without Wi-Fi. (CYW43).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="client_8h.html#a426a50aa91cd43d99cbbce51c651a509" title="Reduces power consumption by disabling unused clocks and reconfiguring system clocks.">client_turn_off_unused_power_consumers()</a> </dd>
<dd>
<a class="el" href="#af3d962ac5095aa3f473afe2979ecd97e" title="Configures the TX pin as input with pull-down for dormant wakeup.">set_pin_as_input_for_dormant_wakeup()</a> </dd></dl>

</div>
</div>
<a id="a40250ad97b28d975e11dedb04e2155ac" name="a40250ad97b28d975e11dedb04e2155ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40250ad97b28d975e11dedb04e2155ac">&#9670;&#160;</a></span>rosc_clear_bad_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rosc_clear_bad_write </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a505de6d7122b8fe20e95bb0dc84bd575" name="a505de6d7122b8fe20e95bb0dc84bd575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a505de6d7122b8fe20e95bb0dc84bd575">&#9670;&#160;</a></span>rosc_disable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rosc_disable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab2239c7a0c007b59d23bb0f7dbb2430c" name="ab2239c7a0c007b59d23bb0f7dbb2430c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2239c7a0c007b59d23bb0f7dbb2430c">&#9670;&#160;</a></span>rosc_enable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rosc_enable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adf98b0492af43397ee03acd23268e637" name="adf98b0492af43397ee03acd23268e637"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf98b0492af43397ee03acd23268e637">&#9670;&#160;</a></span>rosc_set_dormant()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rosc_set_dormant </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a036926488845c153e65c244eb723be" name="a6a036926488845c153e65c244eb723be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a036926488845c153e65c244eb723be">&#9670;&#160;</a></span>rosc_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rosc_write </td>
          <td>(</td>
          <td class="paramtype">io_rw_32 *</td>          <td class="paramname"><span class="paramname"><em>addr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9cbb7880d86f42b6cd982fc5dbb9e629" name="a9cbb7880d86f42b6cd982fc5dbb9e629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cbb7880d86f42b6cd982fc5dbb9e629">&#9670;&#160;</a></span>rosc_write_okay()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool rosc_write_okay </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af3d962ac5095aa3f473afe2979ecd97e" name="af3d962ac5095aa3f473afe2979ecd97e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3d962ac5095aa3f473afe2979ecd97e">&#9670;&#160;</a></span>set_pin_as_input_for_dormant_wakeup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void set_pin_as_input_for_dormant_wakeup </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configures the TX pin as input with pull-down for dormant wakeup. </p>
<p>This function:</p><ul>
<li>Deinitializes the TX pin used in the current UART client connection.</li>
<li>Reinitializes it as a GPIO input.</li>
<li>Enables pull-down resistor to detect future wakeup pulses.</li>
</ul>
<p>Used before entering dormant mode so that the client can wake up when receiving a pulse on its TX pin from the server. </p>

</div>
</div>
<a id="adf5393be97de9f28e2ed9623821af643" name="adf5393be97de9f28e2ed9623821af643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf5393be97de9f28e2ed9623821af643">&#9670;&#160;</a></span>sleep_goto_dormant_until_pin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sleep_goto_dormant_until_pin </td>
          <td>(</td>
          <td class="paramtype">uint</td>          <td class="paramname"><span class="paramname"><em>gpio_pin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>edge</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>high</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Puts the system into dormant mode until a specified GPIO pin triggers a wake-up event. </p>
<p>Configures a GPIO pin as the wake-up source using either edge or level detection, then enters dormant mode. Execution resumes only when the pin event occurs. After wake-up, the interrupt is acknowledged and the pin is deactivated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpio_pin</td><td>The GPIO number to monitor (must be &lt; NUM_BANK0_GPIOS). </td></tr>
    <tr><td class="paramname">edge</td><td>If true, the wake-up will occur on edge detection (rising/falling). If false, level detection (high/low) is used instead. </td></tr>
    <tr><td class="paramname">high</td><td>Determines the polarity:<ul>
<li>If true: rising edge or high level</li>
<li>If false: falling edge or low level</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function blocks until the wake-up event is triggered on the specified pin.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The pin must not be driven with unstable signals during dormant mode, or false wake-ups may occur.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>gpio_set_dormant_irq_enabled() </dd>
<dd>
<a class="el" href="#a9fca88336fe4601d4a5d155157b0c44c">_go_dormant()</a> </dd></dl>

</div>
</div>
<a id="ac7762074b2ad0649a759f25946d3ec7d" name="ac7762074b2ad0649a759f25946d3ec7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7762074b2ad0649a759f25946d3ec7d">&#9670;&#160;</a></span>sleep_power_up()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sleep_power_up </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Restores system clocks and peripherals after wake-up from dormant mode. </p>
<p>Re-enables the ring oscillator (ROSC), resets the sleep enable registers, reinitializes all clock domains, and restores the UART for standard output. On RP2350, also reconfigures the power management timer to use XOSC as source.</p>
<dl class="section note"><dt>Note</dt><dd>This function must be called after waking from dormant mode to restore full functionality of peripherals and system clocks.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Failure to call this function after wake-up may result in malfunctioning peripherals or missing UART output.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>clocks_init() </dd>
<dd>
setup_default_uart() </dd></dl>

</div>
</div>
<a id="a5774403029c05bbcfbf567b0511c2083" name="a5774403029c05bbcfbf567b0511c2083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5774403029c05bbcfbf567b0511c2083">&#9670;&#160;</a></span>sleep_run_from_dormant_source()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sleep_run_from_dormant_source </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a></td>          <td class="paramname"><span class="paramname"><em>dormant_source</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepares the system clocks for low-power dormant wake-up and reinitializes UART. </p>
<p>Configures the clock sources and stops unused clocks (USB, ADC, etc.) to allow the RP2040 to safely enter and resume from dormant mode. Selects a low-power clock source (XOSC or ROSC), disables the unused oscillator, and reinitializes the default UART with the new clock configuration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dormant_source</td><td>The clock source to be used during and after dormant mode. Supported values:<ul>
<li>DORMANT_SOURCE_XOSC (external crystal oscillator)</li>
<li>DORMANT_SOURCE_ROSC (ring oscillator)</li>
<li>DORMANT_SOURCE_LPOSC (low-power oscillator, if available)</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function updates global <span class="tt">_dormant_source</span>, disables PLLs, and stops clocks not needed in low-power state. It must be called <b>before</b> entering dormant mode.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The function assumes both XOSC and ROSC are active initially. It will disable the unused oscillator depending on the selected source.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>setup_default_uart() </dd></dl>

</div>
</div>
<a id="aa31d7757cf6582965276700e895ba493" name="aa31d7757cf6582965276700e895ba493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31d7757cf6582965276700e895ba493">&#9670;&#160;</a></span>wake_up()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wake_up </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wakes up the system from dormant mode and reinitializes UART. </p>
<p>Restores clocks and peripherals using <span class="tt"><a class="el" href="#ac7762074b2ad0649a759f25946d3ec7d" title="Restores system clocks and peripherals after wake-up from dormant mode.">sleep_power_up()</a></span>, then reinitializes UART with stored settings (instance, TX/RX pins, and baud rate).</p>
<dl class="section note"><dt>Note</dt><dd>Assumes <span class="tt">active_uart_client_connection</span> is valid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ac7762074b2ad0649a759f25946d3ec7d" title="Restores system clocks and peripherals after wake-up from dormant mode.">sleep_power_up()</a> </dd>
<dd>
<a class="el" href="functions_8c.html#abe27a9d5a3a9b876eadbd246f80964c5" title="Initializes UART and configures TX/RX GPIO pins.">uart_init_with_pins()</a> </dd></dl>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="aab87f4028722fe344fab2aafea188493" name="aab87f4028722fe344fab2aafea188493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab87f4028722fe344fab2aafea188493">&#9670;&#160;</a></span>_dormant_source</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a146ab45612da7bcaea2f6ef4f91a8c17">dormant_source_t</a> _dormant_source</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2a8bb21ddcce42f2ee025d4f14423fcd" name="a2a8bb21ddcce42f2ee025d4f14423fcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a8bb21ddcce42f2ee025d4f14423fcd">&#9670;&#160;</a></span>go_dormant_flag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool go_dormant_flag = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3a68e44005c8a23a680dce890b33a7f9" name="a3a68e44005c8a23a680dce890b33a7f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a68e44005c8a23a680dce890b33a7f9">&#9670;&#160;</a></span>woke_up_from_dormant</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool woke_up_from_dormant = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_6908ff505388a07996d238c763adbdab.html">client</a></li><li class="navelem"><a href="power__saving__client_8c.html">power_saving_client.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
